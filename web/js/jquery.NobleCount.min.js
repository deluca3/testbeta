/* jQuery.NobleCount v 1.0 http://tpgblog.com/noblecount/
compiled by http://yui.2clics.net/ */
(function(e){function t(t,i,o,u){var a=o.max_chars;var f=e(i);if(!u){var l=f.text();var c=/^[1-9]\d*$/.test(l);if(c){a=l}}s(t,f,o,a,true);e(t).off(".noblecount");e(t).on("keydown.noblecount",function(e){s(t,f,o,a,false);if(!r(e,t,o,a)){n(t,f,o,a);return false}});e(t).on("keyup.noblecount",function(e){s(t,f,o,a,false);if(!r(e,t,o,a)){return false}});e(t).on("paste.noblecount",function(e){setTimeout(function(){s(t,f,o,a,false);if(!r(e,t,o,a)){n(t,f,o,a);return false}},5)})}function n(t,n,r,i){var o=e(t).val();e(t).val(o.substr(0,i));s(t,n,r,i,false)}function r(e,t,n,r){if(n.block_negative){var s=e.which;var o;if(typeof document.selection!="undefined"){o=document.selection.createRange().text.length>0}else{o=t[0].selectionStart!=t[0].selectionEnd}if(!(i(t,r)<1&&(s>47||s==32||s==0||s==13)&&!e.ctrlKey&&!e.altKey&&!o)==false){return false}else if(i(t,r)<1&&e.type=="paste"){return false}}return true}function i(t,n){return n-e(t).val().length}function s(e,t,n,r,s){var u=i(e,r);if(u<0){o(n.on_negative,n.on_positive,e,t,n,u)}else{o(n.on_positive,n.on_negative,e,t,n,u)}if(n.cloak){if(n.in_dom){t.attr("data-noblecount",u)}}else{t.text(u)}if(!s&&jQuery.isFunction(n.on_update)){n.on_update(e,t,n,u)}}function o(e,t,n,r,i,s){if(e!=null){if(typeof e=="string"){r.addClass(e)}else if(jQuery.isFunction(e)){e(n,r,i,s)}}if(t!=null){if(typeof t=="string"){r.removeClass(t)}}}e.fn.NobleCount=function(n,r){var i;var s=false;if(typeof n=="string"||n instanceof jQuery){i=e.extend({},e.fn.NobleCount.settings,r);if(typeof r!="undefined"){s=typeof r.max_chars=="number"?true:false}return this.each(function(){var r=e(this);t(r,n,i,s)})}return this};e.fn.NobleCount.settings={on_negative:null,on_positive:null,on_update:null,max_chars:140,block_negative:false,cloak:false,in_dom:false}})(jQuery)